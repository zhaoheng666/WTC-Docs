## 1、执行活动创建脚本：

脚本路径：WorldTourCasino/scripts  
执行脚本：python create\_activity.py activityName resName

## 2、部分配置文件说明：

step1:添加资源路径 在resource\_dirs/activity里添加ccb资源路径.注意标红位置的资源路径

![0][image1]

step2: 配置活动名称及主题名称到ActivityConfig里面，其中XmasBag跟后端返回活动名称一一对应，templateName是对应活动的主体逻辑文件名称

![0][image2]

step3:配置活动tag,前端自增

![image3](/assets/1758727509979_00725c36.png)

## 3、主体逻辑代码实现

step1: 在src/task/entity目录下创建活动主体代码文件，继承自BaseActivity。BaseActivity是活动基类，实现封装了常用活动功能模块。  
![image4](/assets/1758727509981_4303fc9e.png)

## 4、入口配置

活动一般有两个入口，大厅入口和关卡入口

step1:大厅入口,资源一般以xxx\_entrance.ccb命名,同时实现入口controller绑定ccb。入口controller继承自ActivityEntranceController,实现了常用的一些功能，如倒计时，倒计时变红等功能  
![image5](/assets/1758727509982_ef2c066f.png)  
![image6](/assets/1758727509984_8d357247.png)

step2:关卡入口,资源一般以xxx\_widget.ccb命名,同时实现入口controller绑定ccb。入口controller继承自ActivityBaseWidgetController,实现了常用的一些功能，如倒计时，收集等功能  
![image7](/assets/1758727509985_570c746a.png) ![image8](/assets/1758727509985_b6eb9208.png)

## 5、支付流程

支付流程主要实现在主activity里，主要通过监听具体事件来实现流程。  
购买产品activity.buyProduct=\>购买成功=\>onVeriPurchase弹出奖励弹板=\>领取奖励消耗订单=\>onConsumePruchase同步数据。过程会根据需求有所调整.  
![image9](/assets/1758727509986_b7a39f3b.png)

## 6、活动主界面配置

活动主界面资源一般以xxx\_main.ccb命名,这里需要实现活动主体UI逻辑。

step1:通过主体activity调用popupActivityMainUI弹出界面,一般继承自ActivityMainUIController,其基类实现了丰富的接口，部分可以通过配置搞定，可以按需选择。后续为了提升开发效率，组内开发了活动生成脚本create\_activity.py,可输入资源路径和活动名称一键生成活动基础代码,大大的提高了开发效率，可自行选择使用.  
![image10](/assets/1758727509968_ad555b19.png)

## 7、奖励弹板类配置

活动中比较常见的领奖弹板也有对应封装SmartActivityRewardController。奖励弹板类弹窗继承自该模版类，只需要处理UI即可，该类里处理了大部分的奖励领取  
![image11](/assets/1758727509970_0a2581f4.png)

## 8、条件触发弹板配置

活动比较常见的一个功能是在某些时机触发某些弹板，这些弹板可以通过配置实现,请注意cv只用配置a组，dh需要配置a组和b组。

step1:在PopupID.js中配置弹板tag

![image12](/assets/1758727509970_31a6c5be.png)

step2:在PopupFilterType.js中配置弹板过滤器

![image13](/assets/1758727509971_415ed8f4.png)

step3:在Popup.js中配置弹板触发器

![image14](/assets/1758727509973_454995db.png)

step4:在PopupFilter.js中配置弹板过滤器

![image15](/assets/1758727509974_351d3f17.png)

step5:在popup\_pools.json中添加弹板池配置

![image16](/assets/1758727509975_99f897c2.png)

step6:在trigger\_to\_pools.json中添加弹板弹出时机，比如登录后，返回大厅

![image17](/assets/1758727509977_3ab90617.png)  


































